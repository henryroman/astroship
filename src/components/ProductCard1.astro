---
import { Picture } from "astro:assets";
import { Fragment } from "preact";
const {
  slug,
  name,
  price=0,
  description,
  description2,
  description3,
  description4,
  description5,
  image1,
  image2,
  image3,
  image4,
  ClonePrice,
} = Astro.props;

import Swiper from 'swiper';
import 'swiper/css';

const imageArray = [image1, image2, image3, image4].filter(Boolean);
---

<!-- Loading screen -->
<div id="loading-screen" class="fixed inset-0 flex items-center justify-center bg-white z-50">
  <div class="flex-col gap-4 w-full flex items-center justify-center">
    <div class="w-28 h-28 border-8 text-blue-400 text-4xl animate-spin border-gray-300 flex items-center justify-center border-t-blue-400 rounded-full">
      <svg viewBox="0 0 24 24" fill="currentColor" height="1em" width="1em" class="animate-ping">
        <path d="M12.001 4.8c-3.2 0-5.2 1.6-6 4.8 1.2-1.6 2.6-2.2 4.2-1.8.913.228 1.565.89 2.288 1.624C13.666 10.618 15.027 12 18.001 12c3.2 0 5.2-1.6 6-4.8-1.2 1.6-2.6 2.2-4.2 1.8-.913-.228-1.565-.89-2.288-1.624C16.337 6.182 14.976 4.8 12.001 4.8zm-6 7.2c-3.2 0-5.2 1.6-6 4.8 1.2-1.6 2.6-2.2 4.2-1.8.913.228 1.565.89 2.288 1.624 1.177 1.194 2.538 2.576 5.512 2.576 3.2 0 5.2-1.6 6-4.8-1.2 1.6-2.6 2.2-4.2 1.8-.913-.228-1.565-.89-2.288-1.624C10.337 13.382 8.976 12 6.001 12z"></path>
      </svg>
    </div>
  </div>
</div>

<!-- Main content, hidden initially -->
<div id="page-content" class="hidden">
  <div class="bg-white">
      <div class="pt-6">
        <nav aria-label="Breadcrumb">
          <ol role="list" class="mx-auto flex max-w-2xl items-center space-x-2 px-4 sm:px-6 lg:max-w-7xl lg:px-8">
            <li>
              <div class="flex items-center">
                <a href="../strainList" class="mr-2 text-sm font-medium text-gray-900" aria-current="page">Menu</a>
                <svg width="16" height="20" viewBox="0 0 16 20" fill="currentColor" aria-hidden="true" class="h-5 w-4 text-gray-300">
                  <path d="M5.697 4.34L8.98 16.532h1.327L7.025 4.341H5.697z" />
                </svg>
              </div>
            </li>
            <li>
              <div class="flex items-center">
                <a href="#" aria-current="page" class="mr-2 text-sm font-medium text-gray-900">{name}</a>
                <svg width="16" height="20" viewBox="0 0 16 20" fill="currentColor" aria-hidden="true" class="h-5 w-4 text-gray-300">
                  <path d="M5.697 4.34L8.98 16.532h1.327L7.025 4.341H5.697z" />
                </svg>
              </div>
            </li>
          </ol>
        </nav>

            <!-- Image gallery -->
    <!-- Redesigned Image gallery -->
    <div class="mx-auto mt-6 max-w-2xl sm:px-6 lg:grid lg:max-w-7xl lg:grid-cols-3 lg:gap-x-8 lg:px-8">
      <!-- Main image -->
      <div class="aspect-h-4 aspect-w-3 hidden overflow-hidden rounded-lg lg:block">
        <img src={image1} alt={`${name} image 1`} class="h-full w-full object-cover object-center" />
      </div>
      <!-- Two smaller images -->
      <div class="hidden lg:grid lg:grid-cols-1 lg:gap-y-8">
        {image2 && (
          <div class="aspect-h-2 aspect-w-3 overflow-hidden rounded-lg">
            <img src={image2} alt={`${name} image 2`} class="h-full w-full object-contain"/>
          </div>
        )}
        {image3 && (
          <div class="aspect-h-2 aspect-w-3 overflow-hidden rounded-lg">
            <img src={image3} alt={`${name} image 3`} class="h-full w-full object-cover object-center" />
          </div>
        )}
      </div>
      <!-- Third image or alternative main image for smaller screens -->
      <div class="aspect-h-5 aspect-w-4 lg:aspect-h-4 lg:aspect-w-3 sm:overflow-hidden sm:rounded-lg">
        {image4 ? (
          <img src={image4} alt={`${name} image 4`} class="h-full w-full object-cover object-center" />
        ) : (
          <img src={image4} alt={`${name} image 1`} class="h-full w-full object-cover object-center" />
        )}
      </div>
    </div>

    <!-- Modal Gallery -->
    <div id="modalGallery" class="fixed inset-0 z-50 hidden bg-black bg-opacity-75 flex items-center justify-center">
      <div class="relative w-full h-full max-w-md mx-auto">
        <!-- Close Button -->
        <button id="closeModal" class="absolute top-4 right-4 text-white text-3xl">&times;</button>
        <!-- Swiper -->
        <div class="swiper-container h-full">
          <div class="swiper-wrapper">
            {imageArray.map((imgSrc, index) => (
              <Fragment key={index}>
                <div class="swiper-slide flex items-center justify-center">
                  <img src={imgSrc} alt={`${name} image ${index + 1}`} class="max-h-full max-w-full object-contain">
                </div>
              </Fragment>
            ))}
          </div>
          <div class="swiper-pagination"></div>
          <div class="swiper-button-next"></div>
          <div class="swiper-button-prev"></div>
        </div>
      </div>
    </div>

        <!-- Product info -->
        <div class="mx-auto max-w-2xl px-4 pb-16 pt-10 sm:px-6 grid grid-cols-1 gap-x-8 lg:max-w-7xl lg:grid-cols-3 lg:pb-24 lg:pt-16">
          <!-- Product title -->
          <div class="lg:col-span-2 lg:border-r lg:border-gray-200 lg:pr-8">
            <h1 class="text-2xl font-bold tracking-tight text-gray-900 sm:text-3xl">{name}</h1>
          </div>

          <!-- Options -->
          <div class="mt-4 lg:row-span-3 lg:mt-0">
            <h2 class="sr-only">Product information</h2>
            <p class="text-3xl tracking-tight text-gray-900">${price}</p>

            <!-- Reviews -->
            <div class="mt-6">
              <h3 class="sr-only">Reviews</h3>
              <div class="flex items-center">
                <div class="flex items-center">
                  <!-- Active: "text-gray-900", Default: "text-gray-200" -->
                  <svg class="h-5 w-5 flex-shrink-0 text-gray-900" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                    <path fill-rule="evenodd" d="M10 15l-4.28 2.32.81-4.73L2.18 8.91l4.78-.7L10 4l2.04 4.21 4.78.7-3.45 3.68.81 4.73z" clip-rule="evenodd" />
                  </svg>
                  <svg class="h-5 w-5 flex-shrink-0 text-gray-900" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                    <path fill-rule="evenodd" d="M10 15l-4.28 2.32.81-4.73L2.18 8.91l4.78-.7L10 4l2.04 4.21 4.78.7-3.45 3.68.81 4.73z" clip-rule="evenodd" />
                  </svg>
                  <svg class="h-5 w-5 flex-shrink-0 text-gray-900" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                    <path fill-rule="evenodd" d="M10 15l-4.28 2.32.81-4.73L2.18 8.91l4.78-.7L10 4l2.04 4.21 4.78.7-3.45 3.68.81 4.73z" clip-rule="evenodd" />
                  </svg>
                  <svg class="h-5 w-5 flex-shrink-0 text-gray-900" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                    <path fill-rule="evenodd" d="M10 15l-4.28 2.32.81-4.73L2.18 8.91l4.78-.7L10 4l2.04 4.21 4.78.7-3.45 3.68.81 4.73z" clip-rule="evenodd" />
                  </svg>
                  <svg class="h-5 w-5 flex-shrink-0 text-gray-900" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                    <path fill-rule="evenodd" d="M10 15l-4.28 2.32.81-4.73L2.18 8.91l4.78-.7L10 4l2.04 4.21 4.78.7-3.45 3.68.81 4.73z" clip-rule="evenodd" />
                  </svg>
                </div>
                <p class="sr-only">5 out of 5 stars</p>
                <a href="#" class="ml-3 text-sm font-medium text-indigo-600 hover:text-indigo-500">{Math.floor(Math.random() * 100)} Reviews</a>
              </div>
            </div>

            <!-- Buttons -->
            <form class="mt-10">
              <!-- Buttons -->
              <div>
                <fieldset aria-label="Choose a type" class="mt-4">
                  <div class="flex flex-col space-y-3 sm:flex-row sm:space-y-0 sm:space-x-3">
                    <!-- Button 1 -->
                    <button id="button1" class="group flex justify-around items-center p-2 pl-6 bg-white cursor-pointer border-4 rounded-[15px] relative overflow-hidden z-[100] transition-all duration-[250ms] w-full sm:w-[250px] h-[60px] shadow-[2px_3px_0px_black] hover:translate-x-[1px] hover:translate-y-[1px] hover:shadow-[1px_2px_0px_black] filter active:saturate-[0.75]">
                      <div class="relative flex justify-start items-center overflow-hidden max-w-[60%] text-lg font-semibold h-full">
                        <span class="relative translate-x-[-100%] transition-all duration-[250ms] group-hover:translate-x-0 p-[5px]">Order </span>
                        <span class="relative translate-x-[-100%] transition-all duration-[250ms] group-hover:translate-x-0"> Teens</span>
                      </div>
                      <div class="p-3 mr-3 border-[3px] rounded-full bg-pink-500 relative overflow-hidden transition-all duration-[250ms] z-[100] group-hover:translate-x-[3px]">
                        <svg
                          width="10"
                          height="10"
                          viewBox="0 0 45 38"
                          fill="none"
                          xmlns="http://www.w3.org/2000/svg"
                          class="align-middle"
                        >
                          <path
                            d="M43.7678 20.7678C44.7441 19.7915 44.7441 18.2085 43.7678 17.2322L27.8579 1.32233C26.8816 0.34602 25.2986 0.34602 24.3223 1.32233C23.346 2.29864 23.346 3.88155 24.3223 4.85786L38.4645 19L24.3223 33.1421C23.346 34.1184 23.346 35.7014 24.3223 36.6777C25.2986 37.654 26.8816 37.654 27.8579 36.6777L43.7678 20.7678ZM0 21.5L42 21.5V16.5L0 16.5L0 21.5Z"
                            fill="black"
                          ></path>
                        </svg>
                      </div>
                    </button>
                    <!-- Button 2 -->
                    <button id="button2" class="group flex justify-around items-center p-2 pl-6 bg-white cursor-pointer border-4 rounded-[15px] relative overflow-hidden z-[100] transition-all duration-[250ms] w-full sm:w-[250px] h-[60px] shadow-[2px_3px_0px_black] hover:translate-x-[1px] hover:translate-y-[1px] hover:shadow-[1px_2px_0px_black] filter active:saturate-[0.75]">
                      <div class="relative flex justify-start items-center overflow-hidden max-w-[60%] text-lg font-semibold h-full">
                        <span class="relative translate-x-[-100%] transition-all duration-[250ms] group-hover:translate-x-0 p-[5px]">Order </span>
                        <span class="relative translate-x-[-100%] transition-all duration-[250ms] group-hover:translate-x-0"> Clones</span>
                      </div>
                      <div class="p-3 mr-3 border-[3px] rounded-full bg-pink-500 relative overflow-hidden transition-all duration-[250ms] z-[100] group-hover:translate-x-[3px]">
                        <svg
                          width="10"
                          height="10"
                          viewBox="0 0 45 38"
                          fill="none"
                          xmlns="http://www.w3.org/2000/svg"
                          class="align-middle"
                        >
                          <path
                            d="M43.7678 20.7678C44.7441 19.7915 44.7441 18.2085 43.7678 17.2322L27.8579 1.32233C26.8816 0.34602 25.2986 0.34602 24.3223 1.32233C23.346 2.29864 23.346 3.88155 24.3223 4.85786L38.4645 19L24.3223 33.1421C23.346 34.1184 23.346 35.7014 24.3223 36.6777C25.2986 37.654 26.8816 37.654 27.8579 36.6777L43.7678 20.7678ZM0 21.5L42 21.5V16.5L0 16.5L0 21.5Z"
                            fill="black"
                          ></path>
                        </svg>
                      </div>
                    </button>
                  </div>
                </fieldset>
              </div>
              <!-- Content sections -->
              <div id="content1" class="hidden mt-8">
                <p>Price per teen 6-12" = ${price}</p>
                <p>Price per teen 16"+ = ${(parseInt(price) + 2)}</p>
                <div class="mt-4"></div>
                <p>Call our sales representative to learn more about {name} teens</p>
                <button type="submit" class="mt-10 flex w-full items-center justify-center rounded-md border border-transparent bg-indigo-600 px-8 py-3 text-base font-medium text-white hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2">Call us</button>
              </div>
              <div id="content2" class="hidden mt-8">
                <p>Price per clone = ${ClonePrice}</p>
                <div class="mt-4"></div>
                <p>Call our sales representative to learn more about {name} clones</p>
                <button type="submit" class="mt-10 flex w-full items-center justify-center rounded-md border border-transparent bg-indigo-600 px-8 py-3 text-base font-medium text-white hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2">Call us <a href="+1-714-222-0114"></a></button>
              </div>
            </form>
          </div>

          <!-- Description and details -->
          <div class="py-10 lg:col-span-2 lg:col-start-1 lg:border-r lg:border-gray-200 lg:pb-16 lg:pr-8 lg:pt-6">
            <!-- Description -->
            <div>
              <h3 class="sr-only">Description</h3>
              <div class="space-y-6">
                <p class="text-base text-gray-900 text-[25px]">{/* Your description text if any */  }</p>
              </div>
            </div>
            <!-- Highlights -->
            <div class="mt-10">
              <h3 class="text-lg font-medium text-gray-900 text-[30px]">Highlights</h3>
              <div class="mt-4">
                <ul role="list" class="list-disc space-y-2 pl-4 text-sm">
                  <li class="text-gray-400"><span class="text-gray-600 text-[20px]">{description}</span></li>
                  <li class="text-gray-400"><span class="text-gray-600 text-[20px]">{description2}</span></li>
                  <li class="text-gray-400"><span class="text-gray-600 text-[20px]">{description3}</span></li>
                  <li class="text-gray-400"><span class="text-gray-600 text-[20px]">{description4}</span></li>
                  <li class="text-gray-400"><span class="text-gray-600 text-[20px]">{description5}</span></li>
                </ul>
              </div>
            </div>

            <!-- Details -->
            <div class="mt-10">
              <h2 class="text-sm font-medium text-gray-900">Details</h2>
              <div class="mt-4 space-y-6">
                <p class="text-sm text-gray-600">Our standard Teens come in a 4x4 or 1 gallon coco soil pots and are carefully nurtured to reach 10-18 inches in height and have 6-8 branches.</p>
                <p class="text-sm text-gray-600">Our clones are rigorously cultivated to ensure the highest quality, arriving fully rooted and ready for transplant in a convenient 1.5x1.5 rockwool round plug.</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <style>
      button::after {
        content: "";
        position: absolute;
        inset: 0;
        z-index: -1;
        transform: translateX(-100%);
        transition: transform 250ms;
      }
      button:hover::after {
        transform: translateX(0);
      }

      #modalGallery {
    display: none;
  }
  #modalGallery.active {
    display: flex;
  }

      .arrowContainer::after {
        content: "";
        position: absolute;
        inset: 0;
        border-radius: inherit;
        background-color: #5ad641;
        transform: translateX(-100%);
        z-index: -1;
        transition: transform 250ms ease-in-out;
      }
      button:hover .arrowContainer::after {
        transform: translateX(0);
      }
    </style>

    <script>
  document.addEventListener('DOMContentLoaded', function () {
    const mainImage = document.getElementById('mainImage');
    const modalGallery = document.getElementById('modalGallery');
    const closeModal = document.getElementById('closeModal');

    // Initialize Swiper
    let Swiper;
function initSwiper() {
  Swiper = new Swiper('.swiper-container', {
    loop: true,
    pagination: {
      el: '.swiper-pagination',
      type: 'bullets',
    },
    navigation: {
      nextEl: '.swiper-button-next',
      prevEl: '.swiper-button-prev',
    },
  });
}

    // Show modal on image click (mobile only)
    mainImage?.addEventListener('click', function () {
      if (window.innerWidth < 1024) {
        modalGallery?.classList.add('active');
        if (!Swiper) {
          initSwiper();
        }
      }
    });

    // Close modal
    closeModal?.addEventListener('click', function () {
      modalGallery?.classList.remove('active');
    });

    const button1 = document.getElementById('button1');
    const button2 = document.getElementById('button2');
    const content1 = document.getElementById('content1');
    const content2 = document.getElementById('content2');

    // Handle button clicks
    button1?.addEventListener('click', function (event) {
      event.preventDefault();
      content1?.classList.remove('hidden');
      content2?.classList.add('hidden');
    });

    button2?.addEventListener('click', function (event) {
      event.preventDefault();
      content2?.classList.remove('hidden');
      content1?.classList.add('hidden');
    });

    // Loading screen logic
    const imagesToLoad = document.querySelectorAll('img');
  let imagesLoadedCount = 0;

  function imageLoaded() {
    imagesLoadedCount++;
    if (imagesLoadedCount === imagesToLoad.length) {
      hideLoadingScreen();
    }
  }

  function hideLoadingScreen() {
    const loadingScreen = document.getElementById('loading-screen');
    const pageContent = document.getElementById('page-content');

    if (loadingScreen && pageContent) {
      loadingScreen.style.display = 'none';
      pageContent.classList.remove('hidden');
    }
  }

  imagesToLoad.forEach((img) => {
    if (img.complete) {
      imageLoaded();
    } else {
      img.addEventListener('load', imageLoaded);
      img.addEventListener('error', imageLoaded);
    }
  });

  if (imagesToLoad.length === 0) {
    hideLoadingScreen();
  }
});
  </script>



